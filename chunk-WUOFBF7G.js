import{b as u}from"./chunk-4JWMLXEQ.js";import{Aa as a,K as n,M as s,R as c,S as p,ib as l,m as d}from"./chunk-ZQBLDCAA.js";var f=(()=>{class i{http;envConfig;BASE_URL;constructor(t,e){this.http=t,this.envConfig=e,this.BASE_URL=this.envConfig.API_URL}getAll(t){return this.http.get(`${this.BASE_URL}/${t}`)}getById(t,e){return this.http.get(`${this.BASE_URL}/${t}/${e}`)}create(t,e){return this.http.post(`${this.BASE_URL}/${t}`,e)}update(t,e,r){return this.http.put(`${this.BASE_URL}/${t}/${e}`,r)}delete(t,e){return this.http.delete(`${this.BASE_URL}/${t}/${e}`)}static \u0275fac=function(e){return new(e||i)(c(u),c("ENV_CONFIG"))};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var S=(()=>{class i{entitiesSignal=a([]);get entities(){return this.entitiesSignal.asReadonly()}setEntities(t){this.entitiesSignal.set(t)}addEntity(t){this.entitiesSignal.update(e=>[...e,t])}updateEntity(t,e){this.entitiesSignal.update(r=>r.map(o=>e(o)?t:o))}removeEntity(t){this.entitiesSignal.update(e=>e.filter(r=>!t(r)))}static \u0275fac=function(e){return new(e||i)};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var R=(()=>{class i{apiService=p(f);signalStateService=p(S);apiUrl="products";isLoaded=a(!1);selectedProductId=a(null);selectedProduct=l(()=>{let t=this.selectedProductId();return t?this.products().find(e=>e.id===+t):null});get products(){return this.signalStateService.entities}fetchProducts(){return this.isLoaded()?d(this.products()):this.apiService.getAll(this.apiUrl).pipe(n(t=>{this.isLoaded.set(!0),this.signalStateService.setEntities(t)}))}addProduct(t){return this.apiService.create(this.apiUrl,t).pipe(n(e=>{this.signalStateService.addEntity(e)}))}updateProduct(t,e){this.apiService.update(this.apiUrl,t,e).pipe(n(r=>{this.signalStateService.updateEntity(r,o=>o.id===t)}))}deleteProduct(t){this.apiService.delete(this.apiUrl,t).pipe(n(()=>{this.signalStateService.removeEntity(e=>e.id===t)}))}selectProduct(t){this.selectedProductId.set(t)}clearSelection(){this.selectedProductId.set(null)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();export{R as a};
