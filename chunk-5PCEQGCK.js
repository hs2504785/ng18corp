import{m as g}from"./chunk-TUTJMOXM.js";import{b as f}from"./chunk-TWRZ4ET5.js";import{Gb as h,I as u,Ka as n,Q as o,U as s,Z as d,_ as c,c as p,m as l}from"./chunk-REZRTXQ6.js";var S=(()=>{class i{http;envConfig;BASE_URL;constructor(t,e){this.http=t,this.envConfig=e,this.BASE_URL=this.envConfig.API_URL}getAll(t){return this.http.get(`${this.BASE_URL}/${t}`)}getById(t,e){return this.http.get(`${this.BASE_URL}/${t}/${e}`)}create(t,e){return this.http.post(`${this.BASE_URL}/${t}`,e)}update(t,e,r){return this.http.put(`${this.BASE_URL}/${t}/${e}`,r)}delete(t,e){return this.http.delete(`${this.BASE_URL}/${t}/${e}`)}static \u0275fac=function(e){return new(e||i)(d(f),d("ENV_CONFIG"))};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var v=(()=>{class i{entitiesSignal=n([]);get entities(){return this.entitiesSignal.asReadonly()}setEntities(t){this.entitiesSignal.set(t)}addEntity(t){this.entitiesSignal.update(e=>[t,...e])}updateEntity(t,e){this.entitiesSignal.update(r=>r.map(a=>e(a)?t:a))}removeEntity(t){this.entitiesSignal.update(e=>e.filter(r=>!t(r)))}static \u0275fac=function(e){return new(e||i)};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var w=(()=>{class i{ngbModal=c(g);apiService=c(S);signalStateService=c(v);apiUrl="products";isLoaded=n(!1);isLoading=n(!1);selectedProductId=n(null);selectedProduct=h(()=>{let t=this.selectedProductId();return t?this.products().find(e=>e.id===+t):null});get products(){return this.signalStateService.entities}fetchProducts(){return this.isLoaded()?l(this.products()):(this.isLoading.set(!0),this.apiService.getAll(this.apiUrl).pipe(u(()=>{this.isLoaded.set(!0),this.isLoading.set(!1)}),o(t=>{this.signalStateService.setEntities(t)})))}addProduct(t){return t.image="https://picsum.photos/150/150",this.apiService.create(this.apiUrl,t).pipe(o(e=>{this.signalStateService.addEntity(e)}))}updateProduct(t,e){return this.apiService.update(this.apiUrl,t,e).pipe(o(r=>{this.signalStateService.updateEntity(r,a=>a.id===t)}))}deleteProduct(t){return this.apiService.delete(this.apiUrl,t).pipe(o(()=>{this.signalStateService.removeEntity(e=>e.id===t)}))}selectProduct(t){this.selectedProductId.set(t)}clearSelection(){this.selectedProductId.set(null)}openDialog(t){return p(this,null,function*(){let{ProductDialogComponent:e}=yield import("./chunk-UFMF56TI.js"),r=this.ngbModal.open(e,{centered:!0,scrollable:!0,size:"md",windowClass:"product-dialog"});return t&&(r.componentInstance.data=t),r})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();export{w as a};
